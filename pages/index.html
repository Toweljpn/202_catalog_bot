<!DOCTYPE html>
<html>
  <body style="font-family: sans-serif; max-width:600px;margin:auto;padding:20px;">
    <h2>製品説明チャットボット（試作）</h2>

    <input id="q" style="width:100%;padding:10px;" placeholder="質問を入力..." />
    <button onclick="ask()">送信</button>

    <pre id="out" style="white-space:pre-wrap;margin-top:20px;"></pre>

    <script>
      async function ask() {
        const query = document.getElementById("q").value;

        // ① 検索API
        const s = await fetch("/api/search", {
          method: "POST",
          body: JSON.stringify({ query }),
        });
        const { results } = await s.json();

        // ② 回答生成API
        const c = await fetch("/api/chat", {
          method: "POST",
          body: JSON.stringify({ query, contexts: results }),
        });

        const r = await c.json();
        document.getElementById("out").textContent =
          r.output_text || JSON.stringify(r, null, 2);
      }
    </script>
  </body>
</html>
